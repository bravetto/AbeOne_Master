# Configuration for PoisonGuard

analyzer:
  plugins:
    - name: "keyword"
      class: "heuristics.KeywordPlugin"
      config:
        keyword_list:
          - "exploit"
          - "vulnerability"
          - "pwned"
          - "malicious"
    - name: "length"
      class: "heuristics.LengthPlugin"
      config:
        min_length: 10
        max_length: 5000
    # Model plugin requires optional ML dependencies (torch, transformers)
    # To enable: Install with "pip install '.[ml]'" and uncomment below
    # - name: "model"
    #   class: "model.ModelPlugin"
    #   config:
    #     model_name: "distilbert-base-uncased-finetuned-sst-2-english"
    #     toxicity_threshold: 0.95

mitigator:
  # The default action to take when a threat is detected.
  # Options: "flag", "sanitize", "redact"
  default_action: "flag"

  # Keywords to be removed when the "sanitize" action is used.
  sanitize_keywords:
    - "exploit"
    - "vulnerability"
    - "pwned"
    - "malicious"

logging:
  version: 1
  disable_existing_loggers: False
  formatters:
    standard:
      format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  handlers:
    file:
      class: "logging.FileHandler"
      level: "INFO"
      formatter: "standard"
      filename: "poisonguard.log"
      mode: "a"
  root:
    level: "INFO"
    handlers:
      - "file"