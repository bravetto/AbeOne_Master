# CodeGuardians Gateway - Environment Variables Template
# Copy this file to .env and update with your production values
# Documentation: See app/core/config.py for full details

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
APP_NAME=codeguardians-gateway
APP_VERSION=0.1.0
ENVIRONMENT=development  # Options: development, staging, production, test
DEBUG=false  # Set to true for development only

# ============================================================================
# AWS SECRETS MANAGER (Optional - recommended for production)
# ============================================================================
AWS_SECRETS_ENABLED=true  # Enable AWS Secrets Manager integration
AWS_SECRETS_NAME=codeguardians-gateway/production  # Secret name in AWS Secrets Manager
AWS_REGION=us-east-1  # AWS region for Secrets Manager

# ============================================================================
# SECURITY CONFIGURATION (CRITICAL - CHANGE IN PRODUCTION)
# ============================================================================
SECRET_KEY=change-me-in-production-min-32-chars  # Must be at least 32 characters
ACCESS_TOKEN_EXPIRE_MINUTES=30  # JWT token expiration time
REFRESH_TOKEN_EXPIRE_DAYS=7  # Refresh token expiration time
ALGORITHM=HS256  # JWT algorithm

# ============================================================================
# CLERK AUTHENTICATION (Optional)
# ============================================================================
CLERK_ENABLED=false  # Enable Clerk authentication
CLERK_SECRET_KEY=  # Clerk secret key (required if CLERK_ENABLED=true)
CLERK_PUBLISHABLE_KEY=  # Clerk publishable key
CLERK_WEBHOOK_SECRET=  # Clerk webhook secret for signature verification

# ============================================================================
# STRIPE PAYMENT (Optional)
# ============================================================================
STRIPE_ENABLED=false  # Enable Stripe payments
STRIPE_SECRET_KEY=  # Stripe secret key (required if STRIPE_ENABLED=true)
STRIPE_PUBLISHABLE_KEY=  # Stripe publishable key
STRIPE_WEBHOOK_SECRET=  # Stripe webhook secret

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_ENABLED=true  # Enable database (stateless API can run without DB)
DATABASE_URL=REPLACE_MElocalhost:5432/codeguardians  # PostgreSQL connection string
DATABASE_POOL_SIZE=10  # Connection pool size
DATABASE_MAX_OVERFLOW=20  # Maximum overflow connections
DATABASE_POOL_RECYCLE=3600  # Connection recycle time in seconds
TEST_DATABASE_URL=  # Test database URL (optional, for testing)

# ============================================================================
# REDIS CONFIGURATION (for rate limiting and caching)
# ============================================================================
REDIS_URL=redis://localhost:6379/0  # Redis connection URL
REDIS_HOST=localhost  # Redis host (alternative to REDIS_URL)
REDIS_PORT=6379  # Redis port
REDIS_DB=0  # Redis database number
REDIS_PASSWORD=  # Redis password (if required)

# ============================================================================
# CORS & ALLOWED HOSTS
# ============================================================================
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080,https://aiguardian.ai  # Comma-separated origins
ALLOWED_HOSTS=localhost,127.0.0.1,aiguardian.ai,api.aiguardian.ai,dashboard.aiguardian.ai  # Comma-separated hosts

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # Options: json, text

# ============================================================================
# MONITORING & METRICS
# ============================================================================
ENABLE_METRICS=true  # Enable Prometheus metrics
METRICS_PORT=9090  # Port for Prometheus metrics endpoint (/metrics)

# ============================================================================
# RATE LIMITING CONFIGURATION (Security - Hardening)
# ============================================================================
RATE_LIMIT_ENABLED=true  # Enable rate limiting (recommended: true)
RATE_LIMIT_REQUESTS=100  # Global default requests per minute
RATE_LIMIT_WINDOW=60  # Rate limit window in seconds
RATE_LIMIT_PROCESSING=100  # Requests per minute for /process and /scan endpoints
RATE_LIMIT_ADMIN=5  # Requests per minute for admin endpoints
RATE_LIMIT_READ=200  # Requests per minute for read endpoints (health, services, etc.)

# ============================================================================
# EMAIL CONFIGURATION (Optional)
# ============================================================================
SMTP_HOST=  # SMTP server hostname
SMTP_PORT=587  # SMTP server port
SMTP_USERNAME=  # SMTP username
SMTP_PASSWORD=  # SMTP password
SMTP_TLS=true  # Enable TLS for SMTP

# ============================================================================
# S3 FILE STORAGE (Optional)
# ============================================================================
S3_ENABLED=false  # Enable S3 file storage
S3_BUCKET_NAME=  # S3 bucket name (required if S3_ENABLED=true)
S3_REGION=us-east-1  # AWS region for S3
S3_ACCESS_KEY_ID=  # AWS access key ID
S3_SECRET_ACCESS_KEY=  # AWS secret access key
S3_SESSION_TOKEN=  # AWS session token (for temporary credentials)
S3_ENDPOINT_URL=  # S3 endpoint URL (for local testing with MinIO)

# ============================================================================
# FILE UPLOAD SETTINGS
# ============================================================================
MAX_FILE_SIZE=10485760  # Maximum file size in bytes (10MB)
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf  # Comma-separated MIME types
UPLOAD_EXPIRY_MINUTES=60  # Presigned URL expiry time
FILE_CLEANUP_DAYS=30  # Auto-cleanup files after this many days

# ============================================================================
# SESSION MANAGEMENT
# ============================================================================
SESSION_TTL=3600  # Session TTL in seconds (1 hour)
SESSION_CLEANUP_INTERVAL=300  # Cleanup interval in seconds (5 minutes)
SESSION_STORAGE_TYPE=redis  # Options: redis, database

# ============================================================================
# CACHE CONFIGURATION
# ============================================================================
CACHE_ENABLED=true  # Enable caching
CACHE_TTL=3600  # Cache TTL in seconds (1 hour)

# ============================================================================
# INTERNAL ACCESS TOKEN (Service-to-Service Communication)
# ============================================================================
INTERNAL_ACCESS_TOKEN=aiguardian-internal-token-2024  # Change in production!

# ============================================================================
# INTERNAL TESTING (Development Only)
# ============================================================================
INTERNAL_TESTING_ENABLED=false  # Enable internal testing endpoints
INTERNAL_TESTING_JWT_TOKEN=  # JWT token for testing (required if INTERNAL_TESTING_ENABLED=true)
TESTING=false  # Set to true when running tests

# ============================================================================
# BIASGUARD CONFIGURATION
# ============================================================================
BIASGUARD_ENABLED=true  # Enable BiasGuard service
BIASGUARD_ENFORCE_FAIRNESS=true  # Enforce fairness checks
BIASGUARD_ENFORCE_COMPLIANCE=true  # Enforce compliance checks
BIASGUARD_ENFORCE_ATTRIBUTION=true  # Enforce attribution requirements
BIASGUARD_AUDIT_RETENTION_DAYS=90  # Audit log retention in days
BIASGUARD_MAX_AUDIT_RECORDS=1000000  # Maximum audit records
BIASGUARD_LOG_LEVEL=INFO  # BiasGuard logging level

# ============================================================================
# GUARDIAN ZERO INTEGRATION (Forensic Analysis)
# ============================================================================
GUARDIAN_ZERO_ENABLED=true  # Enable Guardian Zero forensic analysis
GUARDIAN_ZERO_URL=http://guardian-zero:9001  # Guardian Zero service URL

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
# 1. Production must-have changes:
#    - Set SECRET_KEY to a secure random string (32+ characters)
#    - Set ENVIRONMENT=production
#    - Set DEBUG=false
#    - Configure AWS_SECRETS_NAME and AWS_REGION for secrets management
#    - Update INTERNAL_ACCESS_TOKEN to a secure value
#    - Configure REDIS_URL for rate limiting and caching
#    - Set RATE_LIMIT_ENABLED=true
#
# 2. Security hardening (completed):
#    - All endpoints require authentication (admin endpoints require admin access)
#    - Rate limiting with tiered limits (100/5/200 per minute)
#    - Payload size validation (10MB limit)
#    - URL validation for service registration
#    - Service name sanitization
#
# 3. Monitoring setup:
#    - Prometheus metrics available at /metrics
#    - Circuit breaker states at /api/v1/admin/guards/circuit-breakers
#    - Aggregated health at /api/v1/guards/health/aggregated
#    - OpenTelemetry tracing integrated (configure JAEGER_AGENT_HOST/PORT)
# ============================================================================
# OPENTELEMETRY / JAEGER TRACING CONFIGURATION
# ============================================================================
JAEGER_AGENT_HOST=localhost  # Jaeger agent hostname
JAEGER_AGENT_PORT=6831  # Jaeger agent UDP port
JAEGER_ENABLED=false  # Enable distributed tracing (set to true for production)
TRACING_SERVICE_NAME=codeguardians-gateway  # Service name for tracing

# 4. Alerting (configure in Prometheus/Grafana):
#    - Circuit breaker OPEN states (critical)
#    - Service unavailability (warning)
#    - High error rates (>5% 5xx responses) (warning)
#    - Rate limiting violations (info)

