# AIGuards Backend - Unified Environment Configuration Template
# Copy this file to .env and adjust values for your deployment
# NEVER commit .env files to version control!

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================

# Environment: development, production, test
# PRODUCTION: Set to "production" and ensure DEBUG=false
ENVIRONMENT=development

# Version tag for images
VERSION=latest

# =============================================================================
# CORE APPLICATION CONFIGURATION
# =============================================================================

# Application Identity
APP_NAME=aiguards-backend
APP_VERSION=1.0.0
SERVICE_NAME=codeguardians-gateway

# Server Configuration
HOST=0.0.0.0
GATEWAY_PORT=8000

# DEBUG MODE: Set to false in production!
# Development: DEBUG=true
# Production: DEBUG=false
DEBUG=false

LOG_LEVEL=INFO

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Secret key for JWT tokens and encryption (MUST be at least 32 characters)
# PRODUCTION: Generate a secure random key (64+ characters recommended)
# Use: openssl rand -hex 32
SECRET_KEY=CHANGE-ME-IN-PRODUCTION-MINIMUM-32-CHARACTERS-SECURE-KEY

# JWT Configuration
# PRODUCTION: Generate secure keys using: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE-ME-IN-PRODUCTION-JWT-SECRET-KEY
ENCRYPTION_KEY=CHANGE-ME-IN-PRODUCTION-ENCRYPTION-KEY
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
ALGORITHM=HS256

# CORS Configuration
# PRODUCTION: Restrict to your frontend domains only
ALLOWED_ORIGINS=http://localhost:3000,https://bravetto.com,https://www.bravetto.com,https://aiguardians.bravetto.com
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Primary Database Connection
# PRODUCTION: Use AWS Secrets Manager or environment variables
# NEVER embed credentials in URLs - use separate variables instead
DATABASE_URL=REPLACE_ME_WITH_DATABASE_URL

# Database Connection Details (for URL construction)
# PRODUCTION: Store in AWS Secrets Manager
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_USER=neondb_owner
DATABASE_PASSWORD=CHANGE-ME-IN-PRODUCTION-DATABASE-PASSWORD
DATABASE_NAME=neondb
DATABASE_ENABLED=true

# Database Connection Pooling
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_RECYCLE=3600

# Legacy Database Settings (for compatibility)
# PRODUCTION: Use AWS Secrets Manager
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=aiguardian
POSTGRES_PASSWORD=CHANGE-ME-IN-PRODUCTION-POSTGRES-PASSWORD
POSTGRES_DB=aiguardian_unified

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis Connection Details
# PRODUCTION: Use AWS Secrets Manager
# NEVER embed password in URL - use REDIS_PASSWORD instead
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=CHANGE-ME-IN-PRODUCTION-REDIS-PASSWORD

# Redis URL (constructed from above variables)
# For local development with container: REPLACE_MEredis:6379/0
# For production with ElastiCache: REPLACE_MEyour-elasticache-endpoint:6379/0
REDIS_URL=redis://:CHANGE-ME-IN-PRODUCTION-REDIS-PASSWORD@redis:6379/0

# =============================================================================
# EXTERNAL SERVICES CONFIGURATION
# =============================================================================

# Clerk Authentication
# PRODUCTION: Set to true and configure live keys
CLERK_ENABLED=false
CLERK_SECRET_KEY=CHANGE-ME-IN-PRODUCTION-CLERK-SECRET-KEY
CLERK_PUBLISHABLE_KEY=CHANGE-ME-IN-PRODUCTION-CLERK-PUBLISHABLE-KEY
CLERK_WEBHOOK_SECRET=REPLACE_ME

# Stripe Payments
# PRODUCTION: Set to true and configure live keys
STRIPE_ENABLED=false
STRIPE_SECRET_KEY=CHANGE-ME-IN-PRODUCTION-STRIPE-SECRET-KEY
STRIPE_PUBLISHABLE_KEY=CHANGE-ME-IN-PRODUCTION-STRIPE-PUBLISHABLE-KEY
STRIPE_WEBHOOK_SECRET=REPLACE_ME

# Email Configuration
SMTP_HOST=CHANGE-ME-IN-PRODUCTION-SMTP-HOST
SMTP_PORT=587
SMTP_USERNAME=CHANGE-ME-IN-PRODUCTION-SMTP-USERNAME
SMTP_PASSWORD=CHANGE-ME-IN-PRODUCTION-SMTP-PASSWORD
SMTP_TLS=true

# S3 File Storage
# PRODUCTION: Set to true and configure credentials
S3_ENABLED=false
S3_BUCKET_NAME=CHANGE-ME-IN-PRODUCTION-S3-BUCKET-NAME
S3_REGION=us-east-1
S3_ACCESS_KEY_ID=CHANGE-ME-IN-PRODUCTION-S3-ACCESS-KEY-ID
S3_SECRET_ACCESS_KEY=CHANGE-ME-IN-PRODUCTION-S3-SECRET-ACCESS-KEY
S3_SESSION_TOKEN=CHANGE-ME-IN-PRODUCTION-S3-SESSION-TOKEN
S3_ENDPOINT_URL=CHANGE-ME-IN-PRODUCTION-S3-ENDPOINT-URL

# =============================================================================
# AWS CONFIGURATION
# =============================================================================

# AWS Secrets Manager
# PRODUCTION: Set to true to fetch secrets from AWS Secrets Manager
AWS_SECRETS_ENABLED=false
AWS_SECRETS_NAME=codeguardians-gateway/production
AWS_REGION=us-east-1

# AWS Credentials (for AWS Secrets Manager access)
# PRODUCTION: Use IAM roles instead of access keys when possible
AWS_ACCESS_KEY_ID=CHANGE-ME-IN-PRODUCTION-AWS-ACCESS-KEY-ID
AWS_SECRET_ACCESS_KEY=CHANGE-ME-IN-PRODUCTION-AWS-SECRET-ACCESS-KEY
AWS_SESSION_TOKEN=CHANGE-ME-IN-PRODUCTION-AWS-SESSION-TOKEN
AWS_PROFILE=CHANGE-ME-IN-PRODUCTION-AWS-PROFILE

# =============================================================================
# GUARD SERVICES CONFIGURATION
# =============================================================================

# Guard Service URLs (Internal network only)
TOKENGUARD_URL=http://tokenguard:8001
TRUSTGUARD_URL=http://trustguard:8002
CONTEXTGUARD_URL=http://contextguard:8003
BIASGUARD_URL=http://biasguard:8004
HEALTHGUARD_URL=http://healthguard:8005

# BiasGuard Configuration
BIASGUARD_ENABLED=true
BIASGUARD_ENFORCE_FAIRNESS=true
BIASGUARD_ENFORCE_COMPLIANCE=true
BIASGUARD_ENFORCE_ATTRIBUTION=true
BIASGUARD_AUDIT_RETENTION_DAYS=90
BIASGUARD_MAX_AUDIT_RECORDS=1000000

# Unified API Key (fallback when Clerk is disabled)
# PRODUCTION: Generate secure random key
UNIFIED_API_KEY=CHANGE-ME-IN-PRODUCTION-UNIFIED-API-KEY

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Logging
LOG_FORMAT=json

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================

# File Upload
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf
UPLOAD_EXPIRY_MINUTES=60
FILE_CLEANUP_DAYS=30

# =============================================================================
# SESSION MANAGEMENT
# =============================================================================

# Session Configuration
SESSION_TTL=3600
SESSION_CLEANUP_INTERVAL=300
SESSION_STORAGE_TYPE=redis

# =============================================================================
# MONITORING SERVICES (Production Only)
# =============================================================================

# Grafana
# PRODUCTION: Change default password
GRAFANA_PASSWORD=CHANGE-ME-IN-PRODUCTION-GRAFANA-PASSWORD

# =============================================================================
# DEVELOPMENT OVERRIDES
# =============================================================================

# Uncomment for local development ONLY
# DEBUG=true
# LOG_LEVEL=DEBUG
# ENVIRONMENT=development
# AWS_SECRETS_ENABLED=false
# SECRET_KEY=REPLACE_ME
# REDIS_PASSWORD=dev-redis-password-change-in-production
# POSTGRES_PASSWORD=dev-postgres-password-change-in-production

# =============================================================================
# PRODUCTION OVERRIDES
# =============================================================================

# Uncomment for production deployment
# DEBUG=false
# LOG_LEVEL=INFO
# ENVIRONMENT=production
# AWS_SECRETS_ENABLED=true
# CLERK_ENABLED=true
# STRIPE_ENABLED=true
# S3_ENABLED=true
# GATEWAY_PORT=8000
# HOST=0.0.0.0

# =============================================================================
# SECURITY NOTES
# =============================================================================

# 1. NEVER commit .env files to version control
# 2. ALL secrets marked with "CHANGE-ME-IN-PRODUCTION" must be changed
# 3. Use AWS Secrets Manager for production deployments
# 4. Generate secure random keys using: openssl rand -hex 32
# 5. Restrict CORS origins to your frontend domains only
# 6. Ensure DEBUG=false in production
# 7. Use strong passwords (minimum 32 characters for SECRET_KEY)
# 8. Rotate secrets regularly (at least quarterly)
# 9. Use IAM roles instead of access keys when possible
# 10. Never embed passwords in URLs - use separate environment variables
